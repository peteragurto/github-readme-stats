name: Sync Fork Weekly
on:
  schedule:
    - cron: "0 0 * * 0" # Ejecuta todos los domingos a las 00:00 UTC
  workflow_dispatch: # Permite ejecutar el workflow manualmente

jobs:
  sync-fork:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout código
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Clona todo el historial de git
          
      - name: Sincronizar fork con upstream
        run: |
          # Configurar identidad de Git (en el mismo paso donde se usará)
          git config --global user.email "130622718+peteragurto@users.noreply.github.com"
          git config --global user.name "peteragurto"
          echo "✅ Identidad Git configurada"
          
          # Configurar el remoto upstream
          git remote add upstream https://github.com/anuraghazra/github-readme-stats.git
          echo "✅ Remoto 'upstream' configurado"
          
          # Sincronizar cambios
          git fetch upstream
          echo "✅ Cambios descargados desde 'upstream/master'"
          
          git checkout master
          echo "✅ Rama 'master' seleccionada"
          
          # Usar la identidad configurada para el merge
          git merge upstream/master
          echo "✅ Cambios fusionados correctamente"
          
          # Enviar los cambios a origin/master
          git push origin master
          echo "✅ Cambios enviados a tu fork"
